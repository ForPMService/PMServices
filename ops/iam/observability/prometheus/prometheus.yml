# ═══════════════════════════════════════════════════════════════
# Prometheus scrape config
#
# Targets:
#   - OTel Collector :8889  (метрики от .NET через OTLP)
#   - BFF :8080/metrics     (Prometheus exporter в .NET)
#   - IAM API :8080/metrics (Prometheus exporter в .NET)
#   - Keycloak :8080/metrics (KC_METRICS_ENABLED=true)
# ═══════════════════════════════════════════════════════════════

global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: "otel-collector"
    static_configs:
      - targets: ["otel-collector:8889"]

  - job_name: "bff"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["bff:8080"]
    # BFF может быть недоступен (profile: full) — не ломаем Prometheus
    scrape_interval: 30s

  - job_name: "iam-api"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["iam-api:8080"]
    scrape_interval: 30s

  - job_name: "keycloak"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["keycloak:8080"]
    scrape_interval: 30s
